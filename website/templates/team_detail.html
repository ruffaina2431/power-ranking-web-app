{% extends "base.html" %}
<!--
Team Detail Template

This template displays detailed information about a specific team.
Features:
- Team statistics display
- Player roster management
- Date formatting
- Action buttons for team/player management

Displayed Information:
- Team Name: Team's unique identifier
- Captain Phone: Contact information
- Points: Team's earned points
- Wins: Team's victory count
- Rank: Current team ranking
- Creation Date: Team registration date

Player List Features:
- Tabulated player display
- Join dates for each player
- Empty state handling

Navigation:
- Back button to team list
-->
{% block title %}{{ team.name }}{% endblock %}

{% block content %}
<div class="row mt-5">
    <div class="col-lg-4 mb-4">
        <div class="card">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                    <div>
                        <h2 class="card-title mb-1">{{ team.name }}</h2>
                        <p class="text-muted mb-2"><i class="fa fa-phone mr-2"></i> Captain: {{ team.captain_phone or '—' }}</p>
                        {% if team.image %}
                        <img src="{{ url_for('static', filename=team.image) }}?t={{ team.id }}" alt="{{ team.name }} Logo" class="img-fluid rounded" style="max-width: 100px; max-height: 100px;">
                        {% else %}
                        <img src="https://via.placeholder.com/100x100/cccccc/000000?text=No+Image" alt="No Team Image" class="img-fluid rounded" style="max-width: 100px; max-height: 100px;">
                        {% endif %}
                    </div>
                    <div class="text-right">
                        <a href="{{ url_for('views.team_edit', team_id=team.id) }}" class="btn btn-sm btn-outline-warning" title="Edit team"><i class="fa fa-pencil"></i></a>
                        <form method="POST" action="{{ url_for('views.team_delete', team_id=team.id) }}" style="display:inline-block;">
                            <button type="submit" class="btn btn-sm btn-outline-danger" title="Delete team" onclick="return confirm('Delete team? This cannot be undone.');"><i class="fa fa-trash"></i></button>
                        </form>
                    </div>
                </div>

                <hr>

                <div class="d-flex flex-wrap gap-2">
                    <span class="badge badge-pill badge-success mr-2">Points: <strong class="ml-1">{{ team.points or 0 }}</strong></span>
                    <span class="badge badge-pill badge-info mr-2">Wins: <strong class="ml-1">{{ team.wins or 0 }}</strong></span>
                    <span class="badge badge-pill badge-primary mr-2">Rank: <strong class="ml-1">{{ team.rank or '—' }}</strong></span>
                </div>

                <p class="text-muted small mt-3">Created: {{ team.created_date.strftime('%Y-%m-%d') }}</p>

                <div class="mt-3">
                    <a href="{{ url_for('views.teams') }}" class="btn btn-block btn-secondary">← Back to Teams</a>
                </div>
            </div>
        </div>
    </div>

    
    <div class="col-lg-8 mb-4">
        <div class="card bg-dark text-white shadow-sm">
            <div class="card-header">
                <h5 class="mb-0">Players</h5>
            </div>
            <div class="card-body">
                {% if team.players %}
                    <div class="row">
                        {% for player in team.players %}
                            <div class="col-md-4 mb-3">
                                <div class="card bg-secondary text-white h-100">
                                    <div class="card-body text-center">
                                        {% if player.image %}
                                            <img src="{{ url_for('static', filename=player.image) }}?t={{ player.id }}" alt="{{ player.name }} Image" class="card-img-top mb-2 rounded-circle" style="width: 120px; height: 120px; object-fit: cover;">
                                        {% else %}
                                            <img src="https://via.placeholder.com/120x120/cccccc/000000?text=No+Image" alt="No Player Image" class="card-img-top mb-2 rounded-circle" style="width: 120px; height: 120px; object-fit: cover;">
                                        {% endif %}
                                        <h5 class="card-title player-name" data-player-id="{{ player.id }}">{{ player.name }}</h5>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="text-center">
                        <h5 class="card-title">No players yet</h5>
                        <p class="card-text text-muted">This team doesn't have any players added. Once players join, they'll appear here.</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    
    <div class="col-lg-12 mb-4">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Registration History</h5>
            </div>
            <div class="card-body">
                {% if team.tournament_registrations %}
                    <ul class="list-group list-group-flush">
                        {% for reg in team.tournament_registrations %}
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <strong>{{ reg.tournament.name }}</strong>
                                    <br>
                                    <small class="text-muted">Registered on {{ reg.registration_date.strftime('%Y-%m-%d %H:%M') }}</small>
                                </div>
                                <span class="badge badge-{{ 'success' if reg.status == 'approved' else 'warning' if reg.status == 'pending' else 'danger' }}">{{ reg.status|title }}</span>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <div class="text-center">
                        <h5 class="card-title">No Registrations Yet</h5>
                        <p class="card-text text-muted">This team hasn't registered for any tournaments.</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>


</div>



<!-- Small style tweak to keep list-group items compact on dark theme -->
<style>
    .list-group-item-dark { background-color: #1e1e1e; border-color: #333; }
    .badge-pill strong { font-weight: 600; }
</style>


{% endblock %}
